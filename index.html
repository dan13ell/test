<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utfâ€‘8">
  <meta name="viewport" content="width=deviceâ€‘width,initialâ€‘scale=1">
  <title>Popcat Live: ÄŒesko & Slovensko</title>
  <style>
    /* --- Reset + base --- */
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#121212; color:#e0e0e0; fontâ€‘family:Arial, sansâ€‘serif; display:flex; flexâ€‘direction:column; alignâ€‘items:center; padding:20px; }
    h1 { marginâ€‘bottom:20px; }
    .card { background:#1e1e1e; borderâ€‘radius:10px; padding:20px; width:100%; maxâ€‘width:500px; margin:10px; boxâ€‘shadow:0 4px 10px rgba(0,0,0,0.5); transition:transform 0.3s; }
    .card:hover { transform:translateY(-5px); }
    .stat { display:flex; justifyâ€‘content:spaceâ€‘between; margin:10px 0; }
    .label { fontâ€‘size:1.1em; }
    .value { fontâ€‘size:1.3em; fontâ€‘weight:bold; }
    .cpsBar { height:8px; borderâ€‘radius:4px; background:#333; overflow:hidden; margin:5px 0; }
    .cpsFill { height:100%; background:#76ff03; width:0; transition:width 1s easeâ€‘out; }
    @media (maxâ€‘width:600px) {
      .card { padding:15px; }
      .value { fontâ€‘size:1.1em; }
    }
  </style>
</head>
<body>
  <h1>Popcat Live â€“ ğŸ‡¨ğŸ‡¿ ÄŒesko & ğŸ‡¸ğŸ‡° Slovensko</h1>
  <div id="cards"></div>

  <script>
  async function fetchLeaderboard() {
    const resp = await fetch('https://leaderboard.popcat.click/');
    const txt = await resp.text();
    const dom = new DOMParser().parseFromString(txt, 'text/html');
    const rows = Array.from(dom.querySelectorAll('tr'));
    const data = rows.map(r => {
      const tds = r.querySelectorAll('td');
      if (tds.length >= 3) {
        return {
          rank: Number(tds[0].textContent.trim().replace('.', '')) || null,
          country: tds[1].textContent.trim(),
          clicks: Number(tds[2].textContent.trim().replace(/[,.]/g,'')),
          cps: Number((tds[3]?.textContent || '').trim().replace(/[,.]/g,'')) || null
        };
      }
    }).filter(x => x && (x.country === 'Czechia' || x.country === 'Slovakia'));
    return data;
  }

  function updateUI(data) {
    const cards = document.getElementById('cards');
    cards.innerHTML = '';
    data.forEach(d => {
      const card = document.createElement('div');
      card.className = 'card';
      const countryName = d.country === 'Czechia' ? 'ÄŒesko' : 'Slovensko';
      card.innerHTML = `
        <div class="stat"><span class="label">${countryName}</span><span class="value">${d.clicks.toLocaleString()}</span></div>
        <div class="stat"><span class="label">CPS</span><span class="value">${d.cps?.toLocaleString()||'â€“'}</span></div>
        <div class="cpsBar"><div class="cpsFill" style="width: ${d.cps?Math.min(d.cps/50000*100,100):0}%"></div></div>
        <div class="stat"><span class="label">Na pÅ™eskoÄenÃ­ dalÅ¡Ã­:</span><span class="value" id="need-${d.country}">â€¦</span></div>
      `;
      cards.append(card);
    });

    // spoÄÃ­tat rozdÃ­ly
    if (data.length === 2) {
      const [cz, sk] = data[0].country==='Czechia'? data : data.reverse();
      const sorted = [...data].sort((a,b)=>b.clicks - a.clicks);
      sorted.forEach(d => {
        const next = sorted.find(n=>n.clicks> d.clicks);
        const diff = next ? next.clicks - d.clicks + 1 : 0;
        const elem = document.getElementById(`need-${d.country}`);
        elem.textContent = diff > 0 ? diff.toLocaleString() : 'v Äele';
      });
    }
  }

  async function refresh() {
    try {
      const data = await fetchLeaderboard();
      updateUI(data);
    } catch (e) {
      console.error(e);
    }
  }

  // prvotnÃ­ naÄtenÃ­ + perioda kaÅ¾dÃ½ch 10â€¯s
  refresh();
  setInterval(refresh, 10000);
  </script>
</body>
</html>
