<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Live POPCAT CZ vs SK</title>
  <style>/* tmavý styl stejný jako dříve */</style>
</head>
<body>
  <div id="app">Načítám…</div>

  <script>
    const app = document.getElementById('app');
    let last = { cz: 0, sk: 0, time: Date.now() };

    async function updateUI() {
      try {
        const res = await fetch('/data');
        const json = await res.json();

        const cz = json.find(e => e.name === 'Czech Republic');
        const sk = json.find(e => e.name === 'Slovakia');
        const sorted = [...json].sort((a,b) => b.clicks - a.clicks);

        // výpočty
        const now = Date.now();
        const dt = (now - last.time)/1000;
        const cz_cps = ((cz.clicks - last.cz)/dt).toFixed(1);
        const sk_cps = ((sk.clicks - last.sk)/dt).toFixed(1);

        last = { cz: cz.clicks, sk: sk.clicks, time: now };

        const czNext = sorted[sorted.findIndex(e=>e.name=='Czech Republic') - 1] || {};
        const skNext = sorted[sorted.findIndex(e=>e.name=='Slovakia') - 1] || {};

        app.innerHTML = `
          <h1>🇨🇿 CZ vs 🇸🇰 SK</h1>
          <p>CZ: ${cz.clicks} clicks, CPS: ${cz_cps}, na další: ${(czNext.clicks - cz.clicks) || 0}</p>
          <p>SK: ${sk.clicks} clicks, CPS: ${sk_cps}, na další: ${(skNext.clicks - sk.clicks) || 0}</p>
        `;
      } catch(e) {
        app.textContent = 'Chyba: ' + e.message;
      }
    }

    updateUI();
    setInterval(updateUI, 5000);
  </script>
</body>
</html>
